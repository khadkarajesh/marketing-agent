{
  "master": {
    "tasks": [
      {
        "id": "1",
        "title": "Analyze current codebase and stack",
        "description": "Confirmed stack: Vite 7 + React 19 + TypeScript (strict). App entry is frontend/src/main.tsx rendering frontend/src/App.tsx. Styling uses plain CSS (frontend/src/index.css, frontend/src/App.css). No Tailwind, component libraries, or PDF/audio dependencies present. Document findings to inform subsequent tasks; do not modify code.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "details": "Findings based on repository scan under frontend/:\n- Framework/tooling: Vite 7.2.2 with @vitejs/plugin-react 5.1.0 (frontend/vite.config.ts), React 19.2.0, TypeScript ~5.9.3 (frontend/package.json).\n- Entry points: frontend/index.html references /src/main.tsx. frontend/src/main.tsx imports './index.css' and './App.tsx' and uses createRoot(...) with <StrictMode><App/></StrictMode>.\n- TypeScript config: strict mode enabled with bundler resolution and jsx=react-jsx (frontend/tsconfig.app.json). Project references in frontend/tsconfig.json to app and node configs.\n- Styling: Plain CSS via frontend/src/index.css and frontend/src/App.css. No tailwind.config.*, postcss.config.js, *.module.css, or styled-components usage detected.\n- Components: Baseline Vite template present (frontend/src/App.tsx; assets under frontend/src/assets). No shared components directory yet.\n- Media/PDF/audio: No pdfjs-dist, react-pdf, wavesurfer, Web Audio API, or WebSocket usage found in dependencies or source.\n- Paths verified: frontend/package.json, frontend/tsconfig.app.json, frontend/tsconfig.json, frontend/tsconfig.node.json, frontend/vite.config.ts, frontend/src/main.tsx, frontend/src/App.tsx, frontend/src/index.css, frontend/src/App.css, frontend/index.html.",
        "testStrategy": "- Open frontend/package.json to verify: react ^19.2.0, react-dom ^19.2.0, vite ^7.2.2, @vitejs/plugin-react ^5.1.0, typescript ~5.9.3; scripts: dev/build/preview.\n- Confirm strict TypeScript settings in frontend/tsconfig.app.json (\"strict\": true, jsx: \"react-jsx\", moduleResolution: \"bundler\").\n- Validate entry flow: frontend/index.html includes <div id=\"root\"> and loads /src/main.tsx; frontend/src/main.tsx calls createRoot(document.getElementById('root')!).render(<StrictMode><App/></StrictMode>).\n- Verify styling via frontend/src/index.css and frontend/src/App.css; ensure no Tailwind/postcss configs exist.\n- Grep confirms absence of pdfjs-dist/react-pdf/wavesurfer/WebSocket/mediaDevices usage.\n- No code changes performed; this task is documentation-only.",
        "subtasks": [
          {
            "id": 1,
            "title": "Scan repository structure and key config files to identify framework and tooling",
            "description": "List files and directories, focusing on package.json, tsconfig, vite/next configs, and src entries.",
            "dependencies": [],
            "details": "Verified key files under frontend/: package.json, vite.config.ts, tsconfig.json, tsconfig.app.json, tsconfig.node.json, index.html, src/main.tsx, src/App.tsx, src/index.css, src/App.css, src/assets/*. No next.config.* present. No tailwind.config.* or postcss.config.js present. Application lives under frontend/; root contains Task Master/MCP config files.",
            "status": "pending",
            "testStrategy": "Confirm paths exist: frontend/package.json, frontend/vite.config.ts, frontend/tsconfig.app.json, frontend/src/main.tsx, frontend/src/App.tsx, frontend/src/index.css, frontend/src/App.css, frontend/index.html; record them in notes.\n- parentId: undefined\n- file refs: frontend/package.json, frontend/vite.config.ts, frontend/tsconfig.app.json, frontend/src/main.tsx, frontend/src/App.tsx, frontend/src/index.css, frontend/src/App.css, frontend/index.html\n- parentId preserved as provided in source context.\n- No modifications made to code.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Inspect package.json to confirm framework, scripts, and major dependencies",
            "description": "Open package.json to determine framework (Vite/Next), React/TypeScript versions, and scripts.",
            "dependencies": [
              1
            ],
            "details": "frontend/package.json shows:\n- dependencies: react ^19.2.0, react-dom ^19.2.0\n- devDependencies: vite ^7.2.2, @vitejs/plugin-react ^5.1.0, typescript ~5.9.3, eslint ^9.39.1, types for react/node\n- scripts: dev (vite), build (tsc -b && vite build), preview (vite preview), lint (eslint .)\n- No testing libs (e.g., vitest/jest) and no UI libraries configured.",
            "status": "pending",
            "testStrategy": "Conclusions match frontend/package.json contents and scripts; versions align with Vite 7 + React 19 + TS 5.9.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Assess TypeScript configuration and source entry points",
            "description": "Review tsconfig files and main entry files to understand compiler options and app bootstrap.",
            "dependencies": [
              1,
              2
            ],
            "details": "TypeScript: frontend/tsconfig.app.json has \"strict\": true, \"moduleResolution\": \"bundler\", \"jsx\": \"react-jsx\", target ES2022, lib [ES2022, DOM, DOM.Iterable], noEmit true; includes [\"src\"].\nEntry points: frontend/index.html includes <div id=\"root\"></div> and loads /src/main.tsx. frontend/src/main.tsx imports './index.css' and './App.tsx' and calls createRoot(document.getElementById('root')!).render(<StrictMode><App/>). Root component: frontend/src/App.tsx.",
            "status": "pending",
            "testStrategy": "Confirm strict mode and jsx settings in frontend/tsconfig.app.json; verify createRoot pattern and App render path in frontend/src/main.tsx and presence of frontend/src/App.tsx.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Identify styling approach and UI component patterns",
            "description": "Detect Tailwind, CSS modules, or styled-components and existing shared components.",
            "dependencies": [
              1,
              2,
              3
            ],
            "details": "Styling is plain CSS: frontend/src/index.css (globals) and frontend/src/App.css (component styles). No tailwind.config.js, postcss.config.js, *.module.css, or styled-components usage found. Components are limited to baseline template (frontend/src/App.tsx) with assets in frontend/src/assets; no shared component library yet.",
            "status": "pending",
            "testStrategy": "Presence of CSS files validates approach; absence of Tailwind/postcss configs and *.module.css supports conclusions. Example component: frontend/src/App.tsx renders basic counter/logo demo.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Check for media/PDF/audio libraries and summarize findings",
            "description": "Search for pdfjs, audio, or WebSocket usage and produce a concise report of stack and gaps.",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "Search results:\n- No pdfjs-dist/react-pdf, wavesurfer, or audio/WebSocket usage in frontend/* or dependencies. Only transitive postcss in lockfile; no local postcss config.\nSummary:\n- Framework: Vite 7.2.2 + React 19.2.0 + TS 5.9 (strict)\n- Entry: frontend/src/main.tsx -> frontend/src/App.tsx (createRoot)\n- Styling: Plain CSS (frontend/src/index.css, frontend/src/App.css); no Tailwind or component system\n- Components: Baseline demo only; no shared components yet\n- Media/voice: None present\nGaps for future tasks:\n- Task 3 will need ElevenLabs/WebSocket logic and mic permissions; no existing infra\n- Task 5 will require adding pdfjs-dist and worker configuration\n- Task 2 can safely add types/config without conflicting libraries.",
            "status": "pending",
            "testStrategy": "Manual verification: rg shows no hits for pdfjs, react-pdf, wavesurfer, navigator.mediaDevices, or WebSocket in frontend/. Cross-check dependencies in frontend/package.json for absence of media libs.",
            "parentId": "undefined"
          }
        ],
        "complexity": 2,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Use ripgrep/glob to inventory root files (package.json, tsconfig*, vite.config*, next.config*), inspect src/* entry points, and note styling/config. Summarize framework, TS setup, entry points, and gaps. Do not modify code.",
        "updatedAt": "2025-11-15T13:30:11.905Z"
      },
      {
        "id": "2",
        "title": "Define shared TypeScript types and config constants",
        "description": "Shared types and config are now implemented under frontend/src. Verify the exports match requirements, keep the inlined Agent Prompt constant for reuse, and add a Vite-specific .env.example with required keys.",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "priority": "high",
        "details": "Implemented files found and verified in the frontend app:\n- Types at `frontend/src/types.ts` exporting:\n  - `export type Role = 'agent' | 'user'`\n  - `export interface ConversationTurn { role: Role; text: string; timestamp?: number }`\n  - `export interface PdfImage { filename: string; pageNumber: number; dataUrl: string }`\n  - `export interface ClientSearchPayload { conversationTranscript: string; conversationProblemHint?: string; conversationSolutionHint?: string; pdfImages: PdfImage[] }`\n  - File: frontend/src/types.ts\n- Config at `frontend/src/config.ts` exporting env-backed constants and the PRD prompt:\n  - `export const ELEVENLABS_API_KEY = import.meta.env.VITE_ELEVENLABS_API_KEY ?? ''`\n  - `export const ELEVENLABS_AGENT_ID = import.meta.env.VITE_ELEVENLABS_AGENT_ID ?? ''`\n  - `export const CLIENT_SEARCH_URL = import.meta.env.VITE_CLIENT_SEARCH_URL ?? '/client-search'`\n  - `export const ELEVENLABS_AGENT_PROMPT = \\`...exact PRD prompt...\\`` (already inlined)\n  - File: frontend/src/config.ts\n- Vite root confirmed at `frontend/vite.config.ts` and TypeScript strict config at `frontend/tsconfig.app.json` (includes `types: [\"vite/client\"]` so `import.meta.env` is typed).\n- Root `.env.example` exists at `.env.example` (provider keys). A frontend-specific `.env.example` is still needed under `frontend/` for `VITE_*` keys used by config.\n- Future usage: `CLIENT_SEARCH_URL` will be used by Client Search POST flow (Task 7), and `ELEVENLABS_AGENT_PROMPT` will satisfy Task 8 requirements.",
        "testStrategy": "- Run `cd frontend && npm run build` to verify type-check passes and bundling succeeds with strict TS settings.\n- Confirm `import.meta.env.*` resolves (tsconfig includes `types: [\"vite/client\"]`).\n- Optionally `rg` to ensure only `frontend/src/config.ts` reads VITE_* and that constants are imported without causing unused warnings.\n- After adding `frontend/.env.example`, copy to `frontend/.env.local` and verify dev server reads values via `import.meta.env` (e.g., temporary console.log guarded for dev, then remove).",
        "subtasks": [
          {
            "id": 1,
            "title": "Confirm Vite root and scan for existing types/config modules",
            "description": "Inspect the frontend project to verify Vite root, search for existing types.ts/config.ts, and note current env usage patterns.",
            "dependencies": [],
            "details": "Findings: Vite root at `frontend/vite.config.ts`; strict TS at `frontend/tsconfig.app.json` (includes `types: [\"vite/client\"]`). Existing modules already present: `frontend/src/types.ts` (exports Role, ConversationTurn, PdfImage, ClientSearchPayload) and `frontend/src/config.ts` (exports ELEVENLABS_API_KEY, ELEVENLABS_AGENT_ID, CLIENT_SEARCH_URL with fallbacks, and ELEVENLABS_AGENT_PROMPT). `import.meta.env` usage found only in `frontend/src/config.ts`. Proceed with these exact paths.",
            "status": "pending",
            "testStrategy": "None",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Create shared TypeScript types in frontend/src/types.ts",
            "description": "Verify the shared types file exists and matches the required shapes for conversation, PDFs, and client search payload.",
            "dependencies": [
              1
            ],
            "details": "`frontend/src/types.ts` already exports: (1) `type Role = 'agent' | 'user'`; (2) `interface ConversationTurn { role: Role; text: string; timestamp?: number }`; (3) `interface PdfImage { filename: string; pageNumber: number; dataUrl: string }`; (4) `interface ClientSearchPayload { conversationTranscript: string; conversationProblemHint?: string; conversationSolutionHint?: string; pdfImages: PdfImage[] }`. Keep named exports and current formatting.",
            "status": "pending",
            "testStrategy": "Build/type-check to ensure the file compiles under strict TS without unused export issues when imported by future components/hooks.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Add config constants with Vite env fallbacks in frontend/src/config.ts",
            "description": "Expose env-backed constants for API keys/URLs and include the agent prompt placeholder for later replacement.",
            "dependencies": [
              1,
              2
            ],
            "details": "`frontend/src/config.ts` already exports: `ELEVENLABS_API_KEY = import.meta.env.VITE_ELEVENLABS_API_KEY ?? ''`; `ELEVENLABS_AGENT_ID = import.meta.env.VITE_ELEVENLABS_AGENT_ID ?? ''`; `CLIENT_SEARCH_URL = import.meta.env.VITE_CLIENT_SEARCH_URL ?? '/client-search'`; and `ELEVENLABS_AGENT_PROMPT` with the PRD prompt inlined. Keep TODO comments indicating where to set values in `.env.local` and that downstream tasks will consume these constants.",
            "status": "pending",
            "testStrategy": "Type-check by building the project; validate that `import.meta.env` access compiles with `vite/client` types and that the string prompt constant is exported without errors.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Provide Vite env example file at frontend/.env.example",
            "description": "Add a Vite-specific .env.example for the frontend to document required keys and default URL.",
            "dependencies": [
              3
            ],
            "details": "Create `frontend/.env.example` with keys: `VITE_ELEVENLABS_API_KEY=`; `VITE_ELEVENLABS_AGENT_ID=`; `VITE_CLIENT_SEARCH_URL=/client-search`. Note: a root `.env.example` already exists for provider model keys; this frontend file is specifically for Vite runtime env. Include brief comments on purpose and note to copy to `frontend/.env` or `frontend/.env.local` for local dev.",
            "status": "pending",
            "testStrategy": "Manual: copy to `frontend/.env.local`, set sample values, then run `npm run dev` and verify accessibility via `import.meta.env` (temporarily log in dev).",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Verify types/config integration via project type-check/build",
            "description": "Ensure the project compiles cleanly and that the new modules integrate with strict TS and Vite settings.",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "Run `cd frontend && npm run build`. Confirm no unused export warnings introduced, and that `types.ts` and `config.ts` compile under strict settings. Adjust any import paths if necessary when integrated by later hooks/components (e.g., Client Search panel).",
            "status": "pending",
            "testStrategy": "Use `npm run build` (which runs `tsc -b` then `vite build`) to validate.",
            "parentId": "undefined"
          }
        ],
        "complexity": 3,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Confirm Vite root and env patterns, then add src/types.ts and src/config.ts with the specified types and VITE_* env-backed constants plus an agent prompt placeholder. Provide .env.example and verify type-check/build.",
        "updatedAt": "2025-11-15T13:34:04.198Z"
      },
      {
        "id": "3",
        "title": "Implement ElevenLabs conversation hook (Context7)",
        "description": "Create a hook that integrates ElevenLabs Conversational Voice/Agent via WebSocket streaming based on Context7 patterns. The hook is now implemented; remaining work focuses on signed URL auth, optional agent audio playback, and minor ergonomics.",
        "status": "done",
        "dependencies": [
          "2"
        ],
        "priority": "high",
        "details": "- File: `frontend/src/hooks/useElevenLabsConversation.ts`.\n- Current implementation:\n  - Exposes `useElevenLabsConversation()` with `isActive`, `turns: ConversationTurn[]`, `error`, and `startSession`/`stopSession` (frontend/src/hooks/useElevenLabsConversation.ts:104, frontend/src/hooks/useElevenLabsConversation.ts:333).\n  - Connects to `wss://api.elevenlabs.io/v1/convai/conversation` (frontend/src/hooks/useElevenLabsConversation.ts:57) and builds URL params including `agent_id` and temporary `api_key` with TODO to move to signed URLs (frontend/src/hooks/useElevenLabsConversation.ts:222, frontend/src/hooks/useElevenLabsConversation.ts:227, frontend/src/hooks/useElevenLabsConversation.ts:229-231).\n  - Sends conversation init with optional prompt override from `ELEVENLABS_AGENT_PROMPT` via `conversation_config_override` (frontend/src/hooks/useElevenLabsConversation.ts:241-258).\n  - Responds to server `ping` with `pong` (frontend/src/hooks/useElevenLabsConversation.ts:142-149).\n  - Streams mic audio chunks using `MediaRecorder` (`audio/webm;codecs=opus`) as base64 `user_audio_chunk` messages (frontend/src/hooks/useElevenLabsConversation.ts:193-201, frontend/src/hooks/useElevenLabsConversation.ts:201-203).\n  - Parses messages to maintain transcript turns: `user_transcript` (frontend/src/hooks/useElevenLabsConversation.ts:152-156), `agent_response` (frontend/src/hooks/useElevenLabsConversation.ts:159-163), and `agent_response_correction` (frontend/src/hooks/useElevenLabsConversation.ts:166-173). Audio events are stubbed with a TODO for playback (frontend/src/hooks/useElevenLabsConversation.ts:176-178).\n  - Lifecycle and cleanup: on open start recording, on close/error reset state; cleanup on unmount (frontend/src/hooks/useElevenLabsConversation.ts:279-285, frontend/src/hooks/useElevenLabsConversation.ts:287-295, frontend/src/hooks/useElevenLabsConversation.ts:317-325, frontend/src/hooks/useElevenLabsConversation.ts:327-331).\n- Config and types:\n  - Config from `frontend/src/config.ts` (`VITE_ELEVENLABS_API_KEY`, `VITE_ELEVENLABS_AGENT_ID`, `VITE_CLIENT_SEARCH_URL`, prompt) (frontend/src/config.ts:1, frontend/src/config.ts:4, frontend/src/config.ts:7, frontend/src/config.ts:9).\n  - Types from `frontend/src/types.ts` (`Role`, `ConversationTurn`) (frontend/src/types.ts:1, frontend/src/types.ts:3).\n- TODOs to complete:\n  - Replace query param `api_key` with signed URL or header-based auth per ElevenLabs/Context7 guidance.\n  - Implement agent audio playback for `audio_event.audio_base_64` with queueing and optional mute.\n  - Consider an `isConnecting` ref to block rapid double-starts and improve UX docs.\n  - Expand error codes/messages for UI surfacing and retry hints.",
        "testStrategy": "Manual and targeted checks based on current implementation:\n- Happy path: With valid env config, call `startSession()` and observe WebSocket `open`, conversation init sent, `ping/pong` handled, and `turns` populated for both roles. Verify `stopSession()` stops recorder, mic tracks, and closes socket.\n  - Observe URL and params built as expected (signed URL once implemented).\n- Microphone denial: Deny mic; verify `error` is set and no crash; subsequent `startSession()` recovers.\n- Invalid API key (pre-signed flow not yet implemented): Confirm readable `error` and clean reset.\n- Message parsing: Feed mocked `message` events for `user_transcript`, `agent_response`, `agent_response_correction`; assert `turns` updates and callbacks fire.\n- Future: After adding playback, verify queued audio and stop-on-end; test mute toggle and rapid start/stop for leaks.",
        "subtasks": [
          {
            "id": 1,
            "title": "Initialize hook scaffold and types for ElevenLabs conversation in `src/hooks/useElevenLabsConversation.ts`",
            "description": "Create the hook file (if missing) and define core types and public API signatures for the conversation hook.",
            "dependencies": [],
            "details": "Implemented `useElevenLabsConversation` exporting state (`isActive`, `turns`, `error`) and API (`startSession`, `stopSession`) (frontend/src/hooks/useElevenLabsConversation.ts:104, frontend/src/hooks/useElevenLabsConversation.ts:333). Uses shared types imported from `frontend/src/types.ts` (frontend/src/hooks/useElevenLabsConversation.ts:9).",
            "status": "done",
            "testStrategy": "Type-checks compile; import in a dummy component to confirm shape; verify that calling `startSession`/`stopSession` are defined and no runtime errors in mount/unmount.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Implement WebSocket session lifecycle and agent initialization (Context7/ElevenLabs)",
            "description": "Wire up WebSocket connect/disconnect with clean resource management and agent init message per Context7 patterns.",
            "dependencies": [
              1
            ],
            "details": "Starts a WebSocket to `wss://api.elevenlabs.io/v1/convai/conversation` (frontend/src/hooks/useElevenLabsConversation.ts:57) using `buildWebSocketUrl` (frontend/src/hooks/useElevenLabsConversation.ts:222-238). On `open`, sets active, sends conversation init with optional prompt override (frontend/src/hooks/useElevenLabsConversation.ts:279-283, frontend/src/hooks/useElevenLabsConversation.ts:241-258). Responds to `ping` with `pong` (frontend/src/hooks/useElevenLabsConversation.ts:142-149). Cleans up on `close`/`error` and unmount (frontend/src/hooks/useElevenLabsConversation.ts:287-295, frontend/src/hooks/useElevenLabsConversation.ts:327-331). TODO: move to signed URL auth instead of `api_key` query param (frontend/src/hooks/useElevenLabsConversation.ts:229-231).",
            "status": "done",
            "testStrategy": "Manual: `startSession()` then `stopSession()` toggles `isActive`; verify init payload and ping/pong; simulate bad auth to confirm `error` and cleanup.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Capture microphone audio and stream to server as input buffers",
            "description": "Request microphone permission and stream audio chunks using MediaRecorder/WebAudio to the WebSocket per Context7 event schema.",
            "dependencies": [
              2
            ],
            "details": "Requests mic via `getUserMedia({ audio: true })` (frontend/src/hooks/useElevenLabsConversation.ts:273). Starts `MediaRecorder` with `audio/webm;codecs=opus` and on `dataavailable` base64-encodes the chunk and sends `{ user_audio_chunk }` (frontend/src/hooks/useElevenLabsConversation.ts:193-201, frontend/src/hooks/useElevenLabsConversation.ts:201-203). Recorder errors set `error` and reset session (frontend/src/hooks/useElevenLabsConversation.ts:209-214). Tracks stop on `stopSession` and socket close (frontend/src/hooks/useElevenLabsConversation.ts:317-325, frontend/src/hooks/useElevenLabsConversation.ts:287-289).",
            "status": "done",
            "testStrategy": "Manual: grant/deny mic; watch chunk cadence; confirm no chunks after stop; ensure denial sets `error` and subsequent start recovers.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Parse server messages for transcripts and agent replies; update `turns` state",
            "description": "Handle incoming WebSocket messages to build user partial/final transcript turns and agent message turns.",
            "dependencies": [
              2,
              3
            ],
            "details": "Parses JSON messages and updates `turns`: user transcripts (`user_transcription_event.user_transcript`) replace the last user turn (frontend/src/hooks/useElevenLabsConversation.ts:152-156); agent replies append turns (frontend/src/hooks/useElevenLabsConversation.ts:159-163); agent corrections replace last agent turn (frontend/src/hooks/useElevenLabsConversation.ts:166-173). Audio events are currently TODO for playback (frontend/src/hooks/useElevenLabsConversation.ts:176-178). Invokes optional callbacks for partials and agent messages.",
            "status": "done",
            "testStrategy": "Use a test harness to dispatch synthetic `message` events to the WebSocket with sample payloads; assert `turns` state and callback invocation order.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Finalize cleanup, edge-case handling, and developer ergonomics",
            "description": "Harden the hook with cleanup logic, reconnection guards, configuration points, and documentation comments.",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "Cleanup on close/error/unmount is implemented; enhance with an `isConnecting` ref to block rapid double-starts and document expected env keys in README. Replace `api_key` query param with signed URL auth (TODO placed) and implement queued playback for `audio_event.audio_base_64`. Provide brief usage notes and example in file comments.",
            "status": "pending",
            "testStrategy": "Manual: rapid start/stop cycles; unmount during active stream; verify no leaked tracks/sockets. After adding signed URL and audio playback, validate auth flow and playback behavior with mute/stop controls.",
            "parentId": "undefined"
          }
        ],
        "complexity": 8,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Scaffold a React hook managing state and session API; implement WebSocket lifecycle with auth and agent init; stream mic audio via MediaRecorder/WebAudio; parse Context7 transcript/agent messages; finalize cleanup and options.",
        "updatedAt": "2025-11-15T13:43:26.583Z"
      },
      {
        "id": "4",
        "title": "Build VoiceAgentPanel UI",
        "description": "Create a UI component to control the conversation and display a chat-like transcript with live updates.",
        "status": "done",
        "dependencies": [
          "3"
        ],
        "priority": "high",
        "details": "- Files: `frontend/src/components/VoiceAgentPanel.tsx`, `frontend/src/hooks/useElevenLabsConversation.ts`, `frontend/src/App.tsx`.\n- Styling: Tailwind CSS integrated and used for all UI (see `frontend/tailwind.config.js`, `frontend/postcss.config.js`, `frontend/src/index.css`). No separate CSS file is required.\n- UI (implemented):\n  - Primary Start and danger Stop buttons, disabled appropriately by `isActive`.\n  - Live status chip and pulse indicator; shows `Listening…` when active, `Idle` otherwise.\n  - Error chip renders when `error` is present.\n  - Scrollable transcript list with role badges (Agent/Founder) and styled bubbles; container uses `h-72 overflow-y-auto`.\n  - Heuristic Problem/Solution hints displayed alongside the transcript.\n  - A read-only textarea surfaces the full conversation transcript.\n- Logic (implemented):\n  - Wires to `useElevenLabsConversation` for `isActive`, `turns`, `error`, `startSession`, `stopSession`.\n  - Builds `conversationTranscript` with `useMemo` by joining turns using role labels (see `buildTranscript` in `frontend/src/components/VoiceAgentPanel.tsx`).\n  - Extracts hints by scanning recent user turns for keywords (see `extractHints` with `problemKeywords`/`solutionKeywords`).\n- Integration: `frontend/src/App.tsx` hosts the panel in a marketing-ready layout and shows the transcript within the panel’s read-only textarea.\n- Notes:\n  - Auto-scroll to the latest turn is not yet implemented; the transcript list is scrollable. Add a `ref` + `useEffect` in a follow-up to scroll to the last item on updates.\n  - The panel currently displays transcript and hints locally; parent callbacks are optional and can be added when integration requires them (e.g., payload assembly in Client Search).",
        "testStrategy": "- Component tests using a mocked `useElevenLabsConversation` to drive `isActive`, `turns`, `error`, and to spy on `startSession`/`stopSession`:\n  - Verify Start/Stop disabled states toggle correctly.\n  - Confirm status chip shows `Listening…` when `isActive` is true and `Idle` when false.\n  - Inject sequential `turns` and assert list rendering order, role labels, and textarea `value` equals the joined transcript string.\n  - Set `error` and assert the error chip renders with the message.\n- Manual checks in app (`frontend/src/App.tsx`):\n  - Confirm Tailwind styles render (buttons, status chip, bubbles) and the layout is marketing-ready.\n  - Begin a session, speak, and observe live transcript updates and hints. Confirm stopping ends updates. Auto-scroll is a known follow-up.",
        "subtasks": [
          {
            "id": 1,
            "title": "Create VoiceAgentPanel component and directory in frontend/src/components",
            "description": "Set up the base React component file and export to host the conversation controls and transcript UI.",
            "dependencies": [],
            "details": "Component is implemented at `frontend/src/components/VoiceAgentPanel.tsx` using Tailwind classes. It renders controls, status, transcript list, hints, and a read-only transcript textarea. The component is imported and rendered in `frontend/src/App.tsx`. No separate CSS file is needed due to Tailwind.",
            "status": "pending",
            "testStrategy": "Manual: `npm run dev` in `frontend`, confirm `App` renders the panel without type errors and Tailwind styling applies.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Wire Start/Stop controls and active status using useElevenLabsConversation",
            "description": "Connect the component to the hook API to control session lifecycle and show a live status line.",
            "dependencies": [
              1
            ],
            "details": "`frontend/src/components/VoiceAgentPanel.tsx` imports `useElevenLabsConversation` from `frontend/src/hooks/useElevenLabsConversation.ts`. Start triggers `startSession`, Stop triggers `stopSession`. UI reflects `isActive` and shows an error chip when `error` is set. Status chip text is `Listening… mic streaming to ElevenLabs` when active, `Idle` otherwise.",
            "status": "pending",
            "testStrategy": "Mock the hook to simulate `isActive`, `startSession`, `stopSession`, and `error`. Assert button disabled states and presence of status/error chips.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Implement scrollable transcript view with role labels and auto-scroll",
            "description": "Render conversation turns in a fixed-height, scrollable area with clear role labeling and smooth auto-scroll to latest.",
            "dependencies": [
              2
            ],
            "details": "Transcript list is implemented and scrollable via Tailwind (`h-72 overflow-y-auto`) in `frontend/src/components/VoiceAgentPanel.tsx`. Role labels and styled bubbles are applied using `roleStyles`. Auto-scroll is not yet wired; add a `lastItemRef` and `useEffect` to scroll into view when `turns` change.",
            "status": "pending",
            "testStrategy": "Mock `turns` updates and verify items render correctly. After implementing auto-scroll, assert the last item is scrolled into view on updates.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Build and expose conversationTranscript string from turns",
            "description": "Join the turns into a single transcript string and expose it to parent via callback when it changes.",
            "dependencies": [
              3
            ],
            "details": "`conversationTranscript` is computed via `useMemo` and displayed in a read-only `<textarea>` inside the panel (`frontend/src/components/VoiceAgentPanel.tsx`). If parent consumption is required (e.g., Client Search), add an optional `onTranscriptChange?: (t: string) => void` prop and fire it in a `useEffect` tied to `turns`.",
            "status": "pending",
            "testStrategy": "With mocked `turns`, assert the textarea value equals the expected formatted string. If a callback is added, verify it is invoked with the expected transcript on updates.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Add heuristic problemHint/solutionHint extraction and surface via callback",
            "description": "Extract lightweight hints by scanning recent user turns for problem/solution keywords and emit updates to the parent.",
            "dependencies": [
              4
            ],
            "details": "Hints are computed via `extractHints` (`frontend/src/components/VoiceAgentPanel.tsx`) using `problemKeywords` and `solutionKeywords` arrays and displayed in the UI. If needed by integration, add `onHintsChange?: (p?: string, s?: string) => void` and call it when hints change. Debouncing can be added later to avoid excessive updates.",
            "status": "pending",
            "testStrategy": "Feed sample user turns via a mocked hook and verify the hints shown match expectations. If a callback is added, assert calls with expected values; confirm no crashes on empty input.",
            "parentId": "undefined"
          }
        ],
        "complexity": 4,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Create component scaffold; integrate with useElevenLabsConversation to control session; render scrollable transcript with auto-scroll; expose transcript to parent; add simple heuristic hints and callbacks.",
        "updatedAt": "2025-11-15T14:03:21.525Z"
      },
      {
        "id": "5",
        "title": "Implement PDF upload and PDF→image conversion",
        "description": "Allow multiple PDF uploads and convert each page to image Data URLs in the browser using PDF.js.",
        "details": "- Add `pdfjs-dist` if not present; configure worker: `pdfjsLib.GlobalWorkerOptions.workerSrc = new URL('pdf.worker.min.js', import.meta.url).toString()` or CDN per build.\n- File: `src/utils/pdf.ts` with `export async function pdfToImages(file: File): Promise<PdfImage[]>`:\n  - Read file to ArrayBuffer.\n  - `const pdf = await getDocument({ data: arrayBuffer }).promise`.\n  - Loop pages: `const page = await pdf.getPage(i)`; render to offscreen canvas at scale 1.5–2.0; `canvas.toDataURL('image/png')`.\n  - Return `PdfImage[]` including filename and pageNumber.\n- Component: `src/components/PdfUploadPanel.tsx`:\n  - Input (accept `.pdf`, multiple) and drag-and-drop zone.\n  - Show file list and per-file progress; handle errors.\n  - Aggregate results and expose `pdfImages` upward via props/callback.",
        "testStrategy": "Upload 1–2 PDFs; verify image count == page count; throttle network off to ensure no backend calls occur; test corrupted PDF to see handled error state.",
        "priority": "high",
        "dependencies": [
          "2"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Analyze repository for existing PDF utilities, types, and upload patterns",
            "description": "Search the codebase to find any current PDF-related utilities, types, worker setups, or upload UI to align implementation and avoid duplication.",
            "dependencies": [],
            "details": "Use ripgrep to look for files such as `src/utils/pdf.ts`, `src/types.ts`, `src/components/*Upload*.tsx`, and any `pdfjs-dist` references. Identify existing type definitions (e.g., `PdfImage`), progress UI patterns, and worker configuration to follow established conventions.",
            "status": "pending",
            "testStrategy": "Review search results and note findings. No code execution required.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Ensure pdfjs-dist is installed and configure the PDF.js worker",
            "description": "Verify `pdfjs-dist` is present and implement a robust worker configuration suitable for the current build tooling (e.g., Vite/React).",
            "dependencies": [
              1
            ],
            "details": "If missing, add `pdfjs-dist` to dependencies. Create a small initializer (e.g., `src/utils/pdfWorker.ts`) that sets `pdfjsLib.GlobalWorkerOptions.workerSrc = new URL('pdf.worker.min.js', import.meta.url).toString()`. Import this initializer once (e.g., in `src/main.tsx` or within the `pdf.ts` utility prior to first use) to ensure the worker is available.",
            "status": "pending",
            "testStrategy": "Load a trivial PDF via `getDocument` and confirm the worker initializes without console errors or network requests to undefined paths.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Implement pdfToImages utility with page rendering and error handling",
            "description": "Create `src/utils/pdf.ts` exporting `async function pdfToImages(file: File): Promise<PdfImage[]>` to render each PDF page to a PNG Data URL.",
            "dependencies": [
              2
            ],
            "details": "Read the file via `await file.arrayBuffer()`. Call `const pdf = await getDocument({ data: arrayBuffer }).promise`. Loop pages `for (let i=1; i<=pdf.numPages; i++) { const page = await pdf.getPage(i); }`. Render each page to an offscreen canvas using a scale of 1.5–2.0 with `page.getViewport({ scale })`, then `canvas.toDataURL('image/png')`. Return `PdfImage[]` items `{ filename: file.name, pageNumber: i, dataUrl }`. Catch and rethrow with a user-friendly error message for corrupted PDFs.",
            "status": "pending",
            "testStrategy": "Unit test with a small valid PDF and a corrupted file. Assert output length equals page count and that corrupted input yields a handled error without crashing.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Create PdfUploadPanel with multi-file input, drag-and-drop, and progress UI",
            "description": "Add `src/components/PdfUploadPanel.tsx` to accept multiple PDFs, process each with `pdfToImages`, display per-file progress, and surface errors.",
            "dependencies": [
              3
            ],
            "details": "Implement a file input (`accept='.pdf'`, `multiple`) and a drag-and-drop zone. Maintain local state for queued files, per-file progress, and errors. Process files sequentially or with limited concurrency. Aggregate `PdfImage[]` across all files and expose via `onChange(pdfImages: PdfImage[])` callback. Include basic accessibility and keyboard support.",
            "status": "pending",
            "testStrategy": "Manual UI test: upload 1–2 PDFs and verify total images match total pages. Toggle offline mode to ensure no backend calls occur. Drop a corrupted PDF to confirm error display and resilience.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Integrate PdfUploadPanel and plumb pdfImages to consumer components",
            "description": "Mount the new panel in the appropriate parent (e.g., ClientSearchPanel or a shared page), maintain `pdfImages` state, and wire it into downstream flows.",
            "dependencies": [
              4
            ],
            "details": "Add state `const [pdfImages, setPdfImages] = useState<PdfImage[]>([])` in the parent, render `<PdfUploadPanel onChange={setPdfImages} />`, and pass `pdfImages` to consumers. Confirm types match `src/types.ts` and that other features (e.g., Client Search) can access the images. Update any relevant props/contracts.",
            "status": "pending",
            "testStrategy": "End-to-end manual test: upload PDFs, verify `pdfImages` state updates, confirm dependent features receive images, and check no unhandled errors appear in the console.",
            "parentId": "undefined"
          }
        ],
        "complexity": 6,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Audit for existing PDF utils; ensure pdfjs-dist and worker configuration; implement pdfToImages rendering per page; build multi-file upload panel with progress and errors; integrate with parent state."
      },
      {
        "id": "6",
        "title": "Lift and centralize app state",
        "description": "Maintain conversation and PDF data at the App level for cross-panel access and final payload assembly.",
        "details": "- File: `src/App.tsx` (or appropriate root):\n  - State: `turns`, `conversationTranscript`, `problemHint`, `solutionHint`, `pdfImages`.\n  - Render three panels: `VoiceAgentPanel`, `PdfUploadPanel`, `ClientSearchPanel`.\n  - Provide props or React Context to share/update state.\n- Add simple layout and styles matching existing project conventions (CSS modules/Tailwind).",
        "testStrategy": "Manual: engage conversation, upload PDFs; ensure downstream panel previews reflect the latest state; verify no prop drilling bugs via type checks.",
        "priority": "medium",
        "dependencies": [
          "4",
          "5"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Create AppState types and Context scaffolding",
            "description": "Define TypeScript interfaces and a React Context skeleton for centralized app state to be shared across panels.",
            "dependencies": [],
            "details": "Add frontend/src/types/app.ts with ConversationTurn and PdfImage interfaces. Create frontend/src/context/AppStateContext.tsx exporting AppStateContext, AppStateProvider, and useAppState(). Context shape includes: turns, conversationTranscript, problemHint, solutionHint, pdfImages, plus setters and helper actions.",
            "status": "pending",
            "testStrategy": "Type-check the new files; ensure the context and types compile without errors.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Lift state into App and provide via Context",
            "description": "Initialize and manage shared state at the App level and expose it through the Context provider.",
            "dependencies": [
              1
            ],
            "details": "Update frontend/src/App.tsx to wrap its children with <AppStateProvider>. Initialize state for turns, problemHint, solutionHint, pdfImages and derive conversationTranscript from turns (e.g., useMemo). Populate provider value with state and setters.",
            "status": "pending",
            "testStrategy": "Run type checks and ensure App renders with the provider without runtime errors.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Scaffold panel components and connect to Context",
            "description": "Create minimal VoiceAgentPanel, PdfUploadPanel, and ClientSearchPanel components wired to read/write shared state via Context.",
            "dependencies": [
              2
            ],
            "details": "Add frontend/src/components/VoiceAgentPanel.tsx, PdfUploadPanel.tsx, and ClientSearchPanel.tsx. Each uses useAppState() to read required fields and call setter actions; keep logic minimal (placeholders) so compile succeeds.",
            "status": "pending",
            "testStrategy": "Render the panels in isolation via story or simple test page and verify they can read from and invoke context setters without TypeScript errors.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Render panels in App and add basic layout/styles",
            "description": "Compose the three panels inside App and apply simple CSS-based layout consistent with the project’s existing CSS files.",
            "dependencies": [
              3
            ],
            "details": "Modify frontend/src/App.tsx to render the three panels in a responsive grid. Update frontend/src/App.css (and/or index.css) to include a grid container class and basic panel styling matching current CSS conventions (no Tailwind).",
            "status": "pending",
            "testStrategy": "Manual: load the app and verify the three panels render correctly with expected layout and no console errors.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Verify cross-panel state flow and payload readiness",
            "description": "Manually validate that updates in one panel reflect in others and that shared state matches the final payload needs.",
            "dependencies": [
              4
            ],
            "details": "Interact with placeholder controls: simulate adding turns, setting hints, and adding pdfImages to confirm conversationTranscript and counts update across panels. Ensure ClientSearchPanel can access all required fields for payload assembly.",
            "status": "pending",
            "testStrategy": "Manual: run frontend dev server; update state in one panel and observe changes in others; ensure TypeScript types prevent prop-drilling mistakes.",
            "parentId": "undefined"
          }
        ],
        "complexity": 5,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Define AppState types and Context; lift state into App and provider; connect panel skeletons to Context; render panels with basic layout; verify cross-panel state flows."
      },
      {
        "id": "7",
        "title": "Implement Client Search POST flow",
        "description": "Create a panel to construct FormData and POST conversation and PDF images to the backend `/client-search`.",
        "details": "- File: `src/components/ClientSearchPanel.tsx`.\n- Disable `Run Client Search` button until there is either a non-empty transcript or at least one `PdfImage`.\n- On click:\n  - Build `FormData`:\n    - `formData.append('conversationTranscript', conversationTranscript)`.\n    - Optionally append `conversationProblemHint` and `conversationSolutionHint`.\n    - For each image: append `pdfImages[index][filename]`, `[pageNumber]`, `[dataUrl]` as outlined in PRD.\n  - `await fetch(CLIENT_SEARCH_URL, { method: 'POST', body: formData })` with try/catch and a timeout controller.\n- Show loading, success, and error banners; surface non-200 status as errors.\n- Note: strictly client-side; no backend code added.",
        "testStrategy": "Point `CLIENT_SEARCH_URL` to a test receiver; verify payload structure and fields; simulate network error (offline) and confirm UI error state; confirm button disable logic works.",
        "priority": "high",
        "dependencies": [
          "6"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Inventory codebase for ClientSearchPanel, types, and config constants",
            "description": "Scan the repository to find ClientSearchPanel.tsx, related types like PdfImage, and CLIENT_SEARCH_URL configuration to understand current structure and patterns.",
            "dependencies": [],
            "details": "Use `rg --files` and `rg \"ClientSearchPanel|CLIENT_SEARCH_URL|PdfImage|Client Search\" -n src` to locate relevant files. Read `src/components/ClientSearchPanel.tsx` (if exists) plus any `src/types.ts` and `src/config.ts` to confirm available types, props, state, banner/toast components, and fetch utilities.",
            "status": "pending",
            "testStrategy": "Confirm actual file paths and note any existing utilities or components that will be reused.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Assess ClientSearchPanel state, props, and UI entry points for POST flow",
            "description": "Open ClientSearchPanel.tsx to identify where transcript, hints, and pdfImages live, and determine where to attach the POST action and disable logic.",
            "dependencies": [
              1
            ],
            "details": "Inspect current state variables (conversationTranscript, conversationProblemHint, conversationSolutionHint, pdfImages). Identify the Run Client Search button and confirm where to add `disabled` conditions and click handler. Note any existing loading/success/error UI patterns (e.g., Alert, Banner, Toast) to reuse.",
            "status": "pending",
            "testStrategy": "Verify presence of the button and capture the exact variable names for transcript and pdf images for the next step.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Implement FormData construction per PRD and POST with timeout",
            "description": "Create the click handler to build FormData using transcript, optional hints, and pdfImages fields and POST to CLIENT_SEARCH_URL with AbortController timeout and robust error handling.",
            "dependencies": [
              2
            ],
            "details": "In ClientSearchPanel.tsx, on click: `const formData = new FormData(); formData.append('conversationTranscript', conversationTranscript);` Conditionally append `conversationProblemHint` and `conversationSolutionHint` if non-empty. For each image, append `pdfImages[index][filename]`, `pdfImages[index][pageNumber]`, `pdfImages[index][dataUrl]` per PRD. Use `const ac = new AbortController(); set timeout to abort`; `await fetch(CLIENT_SEARCH_URL, { method: 'POST', body: formData, signal: ac.signal })`. Treat non-2xx as errors and surface messages.",
            "status": "pending",
            "testStrategy": "Point CLIENT_SEARCH_URL to a test receiver; inspect multipart fields; simulate timeout and network error to ensure handler sets error state.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Add button gating and request banners for loading, success, and error",
            "description": "Disable Run Client Search unless transcript is non-empty or there is at least one PdfImage, and display banners reflecting request status and errors (including non-200).",
            "dependencies": [
              3
            ],
            "details": "Compute `const canRun = conversationTranscript.trim().length > 0 || pdfImages.length > 0;` Bind `disabled={!canRun || isLoading}`. Track `isLoading`, `successMessage`, `errorMessage` in component state. On success show success banner; on error show error banner with server status/text and any body message. Clear banners between runs.",
            "status": "pending",
            "testStrategy": "Verify disabled state toggles as user types transcript or adds/removes images; confirm banners show for loading, success, non-200, and offline scenarios.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Extract FormData builder and align with project conventions",
            "description": "Refactor to extract a small `buildClientSearchFormData` helper for testability and reuse, and ensure code follows existing project patterns for fetch and UI feedback.",
            "dependencies": [
              4
            ],
            "details": "Create a local helper (or in `src/utils/*` if appropriate) to build FormData from the panel state; keep field names exactly as specified. If a project-wide fetch wrapper or Banner/Alert component exists, replace ad-hoc code to match conventions. Add minimal unit tests for the helper if a test framework exists; otherwise, add runtime assertions/logging in dev.",
            "status": "pending",
            "testStrategy": "Write unit tests to validate required and optional fields and image field naming; run component test for button enable logic if available, else manually verify during development.",
            "parentId": "undefined"
          }
        ],
        "complexity": 5,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Inventory existing panel/config; wire POST handler that builds FormData with transcript/hints/images and timeout; gate button enablement; extract a helper for FormData and align with conventions."
      },
      {
        "id": "8",
        "title": "Embed agent prompt and configuration documentation",
        "description": "Ensure the PRD’s agent prompt is embedded verbatim and add top-level README instructions.",
        "details": "- In `src/config.ts`, export `ELEVENLABS_AGENT_PROMPT` string exactly (or near-exact) as specified.\n- Create/Update `README.md` with:\n  - How to run the app (e.g., Vite `npm run dev`).\n  - Where to set `.env` keys: `VITE_ELEVENLABS_API_KEY`, `VITE_ELEVENLABS_AGENT_ID`, `VITE_CLIENT_SEARCH_URL`.\n  - Notes on ElevenLabs Context7 integration, placeholders to replace, and limitations.\n- Add clear TODO comments near ElevenLabs connection showing where to paste IDs/voice/model.",
        "testStrategy": "Open README and confirm steps are actionable; check that the prompt constant is consumed by the hook; lint/type-check passes.",
        "priority": "medium",
        "dependencies": [
          "2",
          "3",
          "7"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Explore repo to locate config, README, and ElevenLabs references",
            "description": "List files and grep for ElevenLabs/Context7 usage to understand current structure and where to embed the prompt and docs.",
            "dependencies": [],
            "details": "Use ripgrep to enumerate files and search for: 'src/config.ts', 'README.md', '.env', 'VITE_ELEVENLABS_', 'Context7', 'useElevenLabsConversation', 'WebSocket'. Record relevant paths for follow‑up.",
            "status": "pending",
            "testStrategy": "Verify each referenced path exists via rg outputs; note any missing files for creation.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Review src/config.ts and typings to confirm config patterns",
            "description": "Open src/config.ts (and types if present) to learn export style, env var usage, and whether ELEVENLABS_AGENT_PROMPT already exists.",
            "dependencies": [
              1
            ],
            "details": "Check for existing constants (API key, agent ID, client search URL) and how they read env via Vite (import.meta.env). Identify the exact location and naming convention to add ELEVENLABS_AGENT_PROMPT without breaking imports.",
            "status": "pending",
            "testStrategy": "Confirm current exports compile conceptually and list the precise insertion point for the new prompt constant.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Assess README.md and .env handling to define documentation gaps",
            "description": "Open README.md to see if run instructions and environment keys are already documented; identify missing sections required by the task.",
            "dependencies": [
              1
            ],
            "details": "Look for npm/yarn/pnpm run commands (e.g., npm run dev), environment setup instructions, and any ElevenLabs notes. Compare against required keys: VITE_ELEVENLABS_API_KEY, VITE_ELEVENLABS_AGENT_ID, VITE_CLIENT_SEARCH_URL. Note gaps to fill.",
            "status": "pending",
            "testStrategy": "Confirm README presence and content; if absent, plan to create with required sections.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Trace ElevenLabs integration to place TODOs and prompt usage",
            "description": "Find the ElevenLabs hook or connection code that will consume the prompt and add clear TODO comments for IDs/voice/model locations.",
            "dependencies": [
              2
            ],
            "details": "Search in src/hooks and components for WebSocket/ElevenLabs logic (e.g., useElevenLabsConversation). Determine import path for ELEVENLABS_AGENT_PROMPT and exact lines to insert TODOs about pasting Agent ID, voice, and model per Context7.",
            "status": "pending",
            "testStrategy": "Ensure the identified files exist and imports will resolve from src/config.ts; note targeted line ranges.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Prepare precise edit plan for embedding prompt and updating docs",
            "description": "Draft concrete changes: export ELEVENLABS_AGENT_PROMPT verbatim in src/config.ts, update README with run steps, env keys, Context7 notes, and add TODO comments near the ElevenLabs connection code.",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "Align names and formatting with repo conventions. README must include: how to run (Vite dev), where to set VITE_* keys, Context7 integration notes, placeholders to replace, and limitations. Ensure prompt constant is referenced where needed.",
            "status": "pending",
            "testStrategy": "Validate that planned edits are consistent, actionable, and won’t break type/lint checks; verify that the prompt constant will be consumed by the hook.",
            "parentId": "undefined"
          }
        ],
        "complexity": 3,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Locate config/README and ElevenLabs references; add ELEVENLABS_AGENT_PROMPT export; update README with run/env/setup and Context7 notes; add TODOs near connection code about IDs/voice/model."
      },
      {
        "id": "9",
        "title": "Robust error handling and UX polish",
        "description": "Improve resilience and UX for permission errors, socket failures, PDF errors, and POST failures; add minimal styling.",
        "details": "- Mic: detect and display friendly message on permission denial; allow retry.\n- Socket: display reconnect tip; log details to console with safe redaction; ensure `stopSession` cleans resources.\n- PDF: per-file error with filename; continue processing others.\n- POST: show response status; link to retry; guard against double-click with in-flight flag.\n- Auto-scroll transcript; simple responsive layout; keep styles consistent with current project (CSS or Tailwind).",
        "testStrategy": "Manual fault-injection: deny mic, invalid API key, upload broken PDF, toggle offline before POST. Ensure UI remains responsive and informative.",
        "priority": "medium",
        "dependencies": [
          "4",
          "5",
          "7",
          "8"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Scan repo for mic, socket, PDF, POST, and styling code paths",
            "description": "Enumerate files and search code to identify exact components/hooks/utilities handling mic permissions, WebSockets, PDF processing, POST calls, and styling setup.",
            "dependencies": [],
            "details": "Use ripgrep to locate patterns: getUserMedia, WebSocket, fetch/axios, pdf/pdfjs, Tailwind/config, transcript rendering. Read key files to confirm state shapes, error conventions, and UI patterns to follow.",
            "status": "pending",
            "testStrategy": null,
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Implement mic permission denial UX with retry",
            "description": "Add friendly user messaging and a retry flow for mic permission denials or missing devices without duplicating streams.",
            "dependencies": [
              1
            ],
            "details": "Catch NotAllowedError/NotFoundError in mic flow; add error state with visible banner/dialog and a ‘Try again’ that re-requests permission safely; ensure previous tracks are stopped and state reset before retry.",
            "status": "pending",
            "testStrategy": null,
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Improve socket failure UX and ensure stopSession resource cleanup",
            "description": "Show reconnect guidance for socket errors, redact sensitive values in logs, and make stopSession idempotently clean up sockets/listeners/timers/tracks.",
            "dependencies": [
              1,
              2
            ],
            "details": "Handle onerror/onclose with user-facing reconnect tip; console.log with redaction of API keys/tokens; in stopSession close socket, remove listeners, clear timers, stop media tracks; guard to avoid double-cleanup.",
            "status": "pending",
            "testStrategy": null,
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Add per-file PDF error reporting with continue-on-error",
            "description": "Display filename-specific errors for PDFs that fail to parse/render while continuing to process remaining files.",
            "dependencies": [
              1
            ],
            "details": "Wrap per-file PDF parsing in try/catch; collect successes and errors with filenames; render inline per-file error messages near upload list/cards; ensure a single failure does not abort the batch.",
            "status": "pending",
            "testStrategy": null,
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Harden POST flows and polish UX (status, retry, in-flight, auto-scroll, responsive)",
            "description": "Show POST response status and message, provide a retry control, prevent double submissions, auto-scroll transcript, and add minimal responsive styles consistent with current project.",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "Introduce isSubmitting flag to disable buttons; capture/display HTTP status and error text; implement retry that safely replays last request; auto-scroll transcript via ref on new entries; apply small Tailwind/CSS classes for alerts and layout.",
            "status": "pending",
            "testStrategy": null,
            "parentId": "undefined"
          }
        ],
        "complexity": 6,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Scan for mic/socket/PDF/POST code paths; add mic denial UX with retry; improve socket error UX and idempotent cleanup; add per-file PDF error handling; harden POST flow with retry/in-flight and minor responsive styles."
      },
      {
        "id": "10",
        "title": "Light verification scripts and optional tests",
        "description": "Add a manual verification checklist and optional UI smoke tests (no real audio) to validate the end-to-end flow.",
        "details": "- Create `docs/verification.md` with steps to:\n  - Start dev server, set env vars, run a short conversation, upload PDFs, call Client Search.\n- Optional: add a minimal e2e or component test (e.g., Playwright/Cypress or React Testing Library) to confirm panels render and button enablement logic without invoking real APIs (mock hooks/fetch).",
        "testStrategy": "Follow checklist and ensure each step passes; run the smoke test (if added) to confirm core UI elements exist and basic interactions work.",
        "priority": "low",
        "dependencies": [
          "9"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Scan repository to detect framework and testing setup",
            "description": "Enumerate files and inspect package.json to identify the React stack and any existing testing/e2e tools to align verification steps.",
            "dependencies": [],
            "details": "Use ripgrep to list files; open package.json to review scripts/dependencies; search for Vitest/Jest/Cypress/Playwright configuration files to select the minimal harness.",
            "status": "pending",
            "testStrategy": "Confirm detection by verifying package.json entries and presence of config files.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Locate UI components and hooks for smoke tests",
            "description": "Search for panel components and hooks (e.g., VoiceAgentPanel, useElevenLabsConversation, pdfToImages) and read them to choose stable targets with clear enable/disable logic.",
            "dependencies": [
              1
            ],
            "details": "Search src for components/hooks; read code to understand state/props patterns; pick elements with predictable states to assert using mocks.",
            "status": "pending",
            "testStrategy": "Ensure at least one renderable component or hook target is identified and documented with its path.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Create docs/verification.md manual checklist",
            "description": "Author a step-by-step manual guide covering dev server startup, env vars, a short conversation simulation, PDF upload, and Client Search without real audio or network calls.",
            "dependencies": [
              1,
              2
            ],
            "details": "Tailor instructions to detected scripts/env names; include explicit pass/fail criteria, troubleshooting, and notes on using mocks to avoid real APIs.",
            "status": "pending",
            "testStrategy": "Dry-run the checklist locally and verify that every step is actionable and unblocks the next.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Configure minimal smoke testing harness",
            "description": "Set up or adapt the smallest viable test runner (prefer Vitest+React Testing Library if present; otherwise minimal Playwright/Cypress) with mocks to avoid audio/network.",
            "dependencies": [
              1,
              2,
              3
            ],
            "details": "Add test setup and utilities (RTL providers, fetch mocks); if no unit test tooling exists, scaffold a minimal e2e config limited to render checks and state toggles.",
            "status": "pending",
            "testStrategy": "Run the test runner with a placeholder test to validate the setup is green.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Implement smoke tests and npm scripts",
            "description": "Write tests to verify core panels render and buttons enable/disable correctly with mocked hooks/fetch; add npm scripts and README pointers to run verification.",
            "dependencies": [
              4
            ],
            "details": "Create 1–2 smoke tests for panel rendering and interactions; add scripts `test:smoke` and `verify:manual`; link docs/verification.md from README for discoverability.",
            "status": "pending",
            "testStrategy": "Execute `npm run test:smoke` successfully and confirm the README link to docs/verification.md works.",
            "parentId": "undefined"
          }
        ],
        "complexity": 4,
        "recommendedSubtasks": 5,
        "expansionPrompt": "Detect framework and existing test tooling; locate components/hooks to target; author docs/verification.md; set up minimal smoke test harness (prefer Vitest/RTL if present); add 1–2 smoke tests and npm scripts."
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2025-11-15T14:03:21.525Z",
      "taskCount": 10,
      "completedCount": 4,
      "tags": [
        "master"
      ]
    }
  }
}